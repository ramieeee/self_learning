# nextjs

# route

- 기본적으로 route를 위한 라이브러리가 필요 없고 pages 디렉토리 밑에 파일명이 route가 됨.
  만약 파일명이 pages/helloworld.tsx이면 localhost:3000/helloworld 하면 해당 파일로 접근

# dinamic pages

- [id].tsx 와 같이 페이지를 동적으로 동작하도록 설정 가능

# Server Side Rendering

- client에서는 이 함수를 못봄
- 해당 함수는 컴포넌트 바깥에 위치해야함
- 컴포넌트가 마운트 되기 전에 수행됨

```typescript
interface CityData {
  id: string;
  title: string;
  description: string;
  image: string;
}

interface CityObject {
  data: CityData[];
}

export default function Home({ data }: CityObject) {
  return (
    <>
      <Head>
        <title>Create Next App</title>
        <meta name="description" content="Generated by create next app" />
        <meta name="viewport" content="width=device-width, initial-scale=1" />
        <link rel="icon" href="/favicon.ico" />
      </Head>
      <header>
        <nav>
          <img />
          <a href="/" style={{ marginRight: "10px" }}>
            HOME
          </a>
          <a href="/events" style={{ marginRight: "10px" }}>
            Events
          </a>
          <a href="/Helloworld">Hello</a>
        </nav>
        <div>
          {data.map((city: CityData) => {
            return (
              <a
                key={city.id}
                style={{ marginTop: "20px" }}
                href={`/events/${city.id}`}
              >
                <div>{city.title}</div>
                <div>{city.description}</div>
              </a>
            );
          })}
        </div>
      </header>
      <main className={styles.main}></main>
    </>
  );
}

export async function getServerSideProps() {
  const { events_categories } = await import("./data.json");
  return {
    props: {
      data: events_categories,
    },
  };
}
```

# Server side rendering (static)

- 빌드시에 데이터를 가져옴
- 한번 빌드되면 재요청 되지 않음
- getStaticProps() 함수 사용
- getServerSideProps는 컴포넌트가 렌터링 되기 바로 전에 호출

* getStaticPaths는 getStaticProps와 함께 사용됨. [id].tsx와 같이 동적 경로 할당이 가능하기 때문에
  원하는 경로만 getServerSideProps로 데이터를 받아온다음 getStaticPaths로 경로설정을 해줌

```typescript
export async function getStaticPaths() {
  const { allEvents } = await import("../../data.json");

  const allPaths = allEvents.map((ev) => {
    return {
      params: {
        cat: ev.city.toString(),
      },
    };
  });
  return {
    paths: allPaths,
    fallback: false, // 안맞는 path로 가면 작동 안하게 함
  };
}

export async function getStaticProps(context: any) {
  const id = context?.params.cat;
  console.log(id);
  const { allEvents } = await import("../../data.json");

  const data = allEvents.filter((ev) => {
    return ev.city === id;
  });
  console.log(data);

  return {
    props: { data },
  };
}
```

# Link

- a 태그를 하면 새로고침이 되기 때문에 Link를 사용함

```typescript
import Link from "next/link";

<Link href={`/events`} passHref>
  <a>some data</a>
</Link>;
```

# Image

- image를 불러올때는 `<Image/>` 컴포넌트 사용

```typescript
import Image from 'next/image';

export default const Home = () => {
  return
  <div>
    <Image src={`/events/${ev.id}`}/>
  </div>
}
```
